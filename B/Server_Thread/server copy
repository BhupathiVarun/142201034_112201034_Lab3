#!/usr/bin/env bash
# Launcher: ./server <portnum>
set -euo pipefail
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"

LOG_DIR="$SCRIPT_DIR/outputs"
mkdir -p "$LOG_DIR"
LOG_FILE="${SERVER_LOG:-$LOG_DIR/server.out}"

# Mirror stdout+stderr to terminal and log file
exec > >(tee "$LOG_FILE") 2>&1
exec python3 "$SCRIPT_DIR/server_threaded.py" "$@"